<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>이야기 릴레이 - 1인 2턴</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background: #f9f6f1;
      text-align: center;
      padding: 30px;
      color: #333;
    }
    #story-log {
      border: 2px dashed #999;
      padding: 20px;
      margin: 20px auto;
      width: 80%;
      min-height: 150px;
      background-color: #fffbea;
      text-align: left;
      white-space: pre-wrap;
      font-size: 16px;
    }
    input, button {
      padding: 10px 15px;
      font-size: 16px;
      margin: 10px 5px;
      border-radius: 8px;
      border: 1.5px solid #555;
      transition: background-color 0.3s ease;
      cursor: pointer;
    }
    input {
      width: 60%;
      max-width: 500px;
    }
    button:hover:not(:disabled) {
      background-color: #f2d388;
    }
    button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }
    #topic-box {
      font-size: 20px;
      font-weight: bold;
      color: #555;
      margin-bottom: 20px;
      min-height: 60px;
      background-color: #fff9f0;
      border: 2px solid #f2d388;
      border-radius: 10px;
      padding: 15px;
      box-shadow: 1px 1px 5px rgba(0,0,0,0.1);
    }
    #player-info {
      font-weight: 600;
      margin: 5px 0 15px;
      font-size: 18px;
    }
    #fun-illustration {
      margin: 25px auto;
      width: 120px;
      height: 120px;
      user-select: none;
    }
  </style>
</head>
<body>
  <h1>📖 이야기 릴레이 - 1인 2턴</h1>
  <p>한 사람당 두 번씩 돌아가며 문장을 이어보세요!<br>시작 문장은 '전 문장'에 표시됩니다.</p>
  
  <div id="topic-box">🎲 전 문장: (시작 문장을 먼저 생성하세요!)</div>
  <button id="btn-random-topic" onclick="generateRandomTopic()">랜덤 전 문장 생성</button>
  <br><br>

  <div id="player-info">
    현재 플레이어: <span id="player-num">-</span> / 5 &nbsp;&nbsp;|&nbsp;&nbsp; 총 턴: <span id="turn-count">-</span> / 10
  </div>
  
  <input type="text" id="sentence-input" placeholder="문장을 입력하세요" autocomplete="off" />
  <br>
  <button id="btn-submit" onclick="submitSentence()" disabled>입력</button>
  <button id="btn-show-story" onclick="showStory()" disabled>전체 이야기 보기</button>

  <div id="story-log" style="display:none;"></div>

  <!-- 고등학생 웃길만한 간단 재미있는 그림 (SVG) -->
  <svg id="fun-illustration" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" aria-label="웃는 얼굴 그림" role="img">
    <circle cx="32" cy="32" r="30" fill="#FFD93B" stroke="#F4C534" stroke-width="3"/>
    <circle cx="22" cy="24" r="5" fill="#333" />
    <circle cx="42" cy="24" r="5" fill="#333" />
    <path d="M20 44 Q32 54 44 44" stroke="#333" stroke-width="4" fill="none" stroke-linecap="round"/>
    <line x1="17" y1="28" x2="12" y2="24" stroke="#333" stroke-width="3" />
    <line x1="47" y1="28" x2="52" y2="24" stroke="#333" stroke-width="3" />
    <text x="10" y="60" font-size="7" fill="#444" font-family="Arial" >ㅋㅋㅋ 웃자!</text>
  </svg>

<script>
  const randomTopics = [
    "수업 시간에 갑자기 친구들이 춤을 추기 시작했다.",
    "내 점심 도시락에서 갑자기 불꽃이 튀었다.",
    "급식실에서 선생님이 랩 배틀을 시작하셨다.",
    "내가 마법처럼 좋아하는 간식을 한아름 받았다.",
    "친구가 나 대신 갑자기 수업을 맡았다!",
    "교실에 깜짝 콘서트가 열렸다.",
    "운동장에서 갑자기 불꽃놀이가 터졌다.",
    "선생님이 갑자기 힙합 댄스를 보여주셨다.",
    "내 이름이 학교 전광판에 반짝반짝 빛났다.",
    "복도에서 갑자기 유명 아이돌이 나타났다!",
    // 기존 문장 유지
    "내 옆자리에 어느 날 갑자기 전학생이 앉았는데, 그 애는 나와 똑같이 생겼다.",
    "교무실에서 이상한 비밀 지도를 발견했다.",
    "내가 쓴 연애편지가 반 전체 단톡방에 올라갔다.",
    "교장 선생님이 갑자기 스트리머로 데뷔하셨다.",
    "화장실 거울 속 내 얼굴이 계속 윙크를 했다.",
    "급식실 아주머니가 내 이름을 정확히 알고 계셨다. 나는 처음 봤는데.",
    "나의 그림자가 갑자기 말을 걸어왔다."
  ];

  let sentences = [];
  let turn = 0;  // 턴이 시작 전이므로 0
  let topicSet = false;

  // 랜덤 시작 문장 생성 (한 번만 가능)
  function generateRandomTopic() {
    if (topicSet) return;
    const topic = randomTopics[Math.floor(Math.random() * randomTopics.length)];
    sentences = [topic];
    topicSet = true;
    turn = 1;

    document.getElementById("topic-box").textContent = `🎲 전 문장: "${topic}"`;
    document.getElementById("sentence-input").value = "";
    document.getElementById("player-num").textContent = 1;
    document.getElementById("turn-count").textContent = 1;
    document.getElementById("btn-random-topic").disabled = true;
    document.getElementById("btn-submit").disabled = false;
    document.getElementById("btn-show-story").disabled = true;

    alert("시작 문장이 생성되었습니다! 플레이어 1 차례입니다.");
    document.getElementById("sentence-input").focus();
  }

  function submitSentence() {
    if (!topicSet) {
      alert("먼저 랜덤 전 문장을 생성해주세요!");
      return;
    }

    const input = document.getElementById("sentence-input");
    const sentence = input.value.trim();

    if (sentence === "") {
      alert("문장을 입력해주세요.");
      return;
    }

    // 새 문장은 이전 문장 다음에 위치
    sentences.push(sentence);
    input.value = "";

    if (turn < 10) {
      turn++;
      const player = ((turn - 1) % 5) + 1;

      // 전 문장 갱신 (마지막에 입력한 문장)
      document.getElementById("topic-box").textContent = `🎲 전 문장: "${sentence}"`;

      document.getElementById("turn-count").textContent = turn;
      document.getElementById("player-num").textContent = player;

      alert(`플레이어 ${player} 차례입니다!`);
      input.focus();
    } else {
      // 10턴 완료
      document.getElementById("turn-count").textContent = turn;
      document.getElementById("player-num").textContent = "-";
      alert("모든 플레이어가 두 번씩 입력을 마쳤습니다.\n'전체 이야기 보기' 버튼을 눌러주세요!");
      document.getElementById("btn-submit").disabled = true;
      document.getElementById("btn-show-story").disabled = false;
      input.value = "";
      input.disabled = true;
    }
  }

  function showStory() {
    const log = document.getElementById("story-log");
    log.style.display = "block";
    log.innerHTML = `<strong>📘 최종 이야기:</strong>\n\n` + sentences.map((s, i) => `(${i+1}) ${s}`).join("\n");
  }

  // 엔터키로 입력 가능
  document.getElementById("sentence-input").addEventListener("keydown", function(event) {
    if (event.key === "Enter") {
      submitSentence();
    }
  });
</script>
</body>
</html>
